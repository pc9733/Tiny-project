<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Company Opportunities — by Location</title>
  <link rel="stylesheet" href="assets/style.css"/>
</head>
<body>
  <header class="topbar">
    <h1 id="title">Company Opportunities</h1>
    <nav class="nav">
      <a href="index.html">All</a>
      <a href="location.html?loc=gurgaon">Gurgaon</a>
      <a href="location.html?loc=gurugram">Gurugram</a>
      <a href="location.html?loc=gurgaon_noida">Gurgaon + Noida</a>
      <a href="location.html?loc=noida">Noida</a>
      <a href="location.html?loc=remote">Remote</a>
    </nav>
  </header>

  <main class="container">
    <div class="toolbar">
      <input id="search" class="search" placeholder="Search companies or URL…"/>
      <button class="btn primary" id="btnAdd">+ Add Company</button>
      <button class="btn" id="exportBtn">Export</button>
      <label class="btn" for="importFile">Import</label>
      <input type="file" id="importFile" accept="application/json" hidden>
    </div>

    <section class="card">
      <table id="table">
        <thead>
        <tr>
          <th style="width:34%">Company</th>
          <th style="width:18%">Location</th>
          <th data-col="url">Careers URL</th>
          <th style="width:180px">Actions</th>
        </tr>
        </thead>
        <tbody id="tbody">
        <tr><td class="empty" colspan="4">Loading…</td></tr>
        </tbody>
      </table>
    </section>

    <div id="empty" class="empty" style="display:none">No records.</div>

    <p class="muted tip">
      Viewing a filtered list. Use the navigation to switch locations or go back to All.
    </p>
  </main>

  <!-- Add/Edit Modal (reused) -->
  <dialog id="modal">
    <form method="dialog" id="form" class="modal">
      <h3 id="modalTitle">Add Company</h3>
      <div class="grid grid-2">
        <div>
          <label for="company">Company</label>
          <input id="company" name="company" type="text" required/>
        </div>
        <div>
          <label for="location">Location</label>
          <select id="location" name="location" required>
            <option value="">Select</option>
            <option>Gurgaon</option>
            <option>Gurugram</option>
            <option>Gurgaon + Noida</option>
            <option>Noida</option>
            <option>Delhi</option>
            <option>Remote</option>
          </select>
        </div>
        <div class="grid" style="grid-column:1/-1">
          <label for="url">Careers URL</label>
          <input id="url" name="url" type="url" required/>
        </div>
      </div>
      <div class="row">
        <button class="btn" type="button" id="btnCancel" value="cancel">Cancel</button>
        <button class="btn primary" id="saveBtn" value="default">Save</button>
      </div>
      <input type="hidden" id="id" name="id"/>
    </form>
  </dialog>

  <script src="assets/app.js"></script>
  <script>
    // normalize & map code -> pretty label
    const params = new URLSearchParams(location.search);
    let loc = (params.get("loc") || "gurgaon").trim().toLowerCase();

    // treat 'gurugram' as 'gurgaon'
    if (loc === "gurugram") loc = "gurgaon";

    const LABELS = {
      gurgaon: "Gurgaon",
      noida: "Noida",
      remote: "Remote",
      delhi: "Delhi",
      gurgaon_noida: "Gurgaon + Noida"
    };

    const pretty = LABELS[loc] || "Gurgaon";
    document.getElementById("title").textContent = `Company Opportunities — ${pretty}`;

    // Mount in filtered mode with normalized code
    App.mount({ mode: "filtered", location: loc });
  </script>
</body>
</html>
